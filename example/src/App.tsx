import * as React from 'react';
import { useEffect, useRef } from 'react';

import { StyleSheet, View } from 'react-native';
import {
  CandleSticksChart,
  CandleSticksChartRef,
} from 'react-native-rn-charts';

const candles = [
  {
    close: 1.07385,
    high: 1.0739,
    low: 1.0738,
    open: 1.0738,
    time: 1675736640000,
    volume: 0,
  },
  {
    close: 1.07387,
    high: 1.0739,
    low: 1.07377,
    open: 1.07385,
    time: 1675736700000,
    volume: 0,
  },
  {
    close: 1.07392,
    high: 1.07396,
    low: 1.07384,
    open: 1.07386,
    time: 1675736760000,
    volume: 0,
  },
  {
    close: 1.07392,
    high: 1.07396,
    low: 1.07388,
    open: 1.07392,
    time: 1675736820000,
    volume: 0,
  },
  {
    close: 1.07397,
    high: 1.074,
    low: 1.0739,
    open: 1.07393,
    time: 1675736880000,
    volume: 0,
  },
  {
    close: 1.07397,
    high: 1.07401,
    low: 1.07392,
    open: 1.07399,
    time: 1675736940000,
    volume: 0,
  },
  {
    close: 1.07396,
    high: 1.07397,
    low: 1.07387,
    open: 1.07397,
    time: 1675737000000,
    volume: 0,
  },
  {
    close: 1.07405,
    high: 1.07406,
    low: 1.07396,
    open: 1.07396,
    time: 1675737060000,
    volume: 0,
  },
  {
    close: 1.07401,
    high: 1.07406,
    low: 1.07399,
    open: 1.07405,
    time: 1675737120000,
    volume: 0,
  },
  {
    close: 1.07405,
    high: 1.07407,
    low: 1.07397,
    open: 1.07397,
    time: 1675737180000,
    volume: 0,
  },
  {
    close: 1.07392,
    high: 1.0741,
    low: 1.07392,
    open: 1.07406,
    time: 1675737240000,
    volume: 0,
  },
  {
    close: 1.07391,
    high: 1.07394,
    low: 1.07385,
    open: 1.07392,
    time: 1675737300000,
    volume: 0,
  },
  {
    close: 1.0739,
    high: 1.07392,
    low: 1.07386,
    open: 1.07392,
    time: 1675737360000,
    volume: 0,
  },
  {
    close: 1.07386,
    high: 1.07396,
    low: 1.07386,
    open: 1.0739,
    time: 1675737420000,
    volume: 0,
  },
  {
    close: 1.07385,
    high: 1.07389,
    low: 1.0738,
    open: 1.07386,
    time: 1675737480000,
    volume: 0,
  },
  {
    close: 1.0738,
    high: 1.07385,
    low: 1.07377,
    open: 1.07385,
    time: 1675737540000,
    volume: 0,
  },
  {
    close: 1.07374,
    high: 1.07381,
    low: 1.07365,
    open: 1.07381,
    time: 1675737600000,
    volume: 0,
  },
  {
    close: 1.07365,
    high: 1.07373,
    low: 1.0736,
    open: 1.07373,
    time: 1675737660000,
    volume: 0,
  },
  {
    close: 1.0738,
    high: 1.0738,
    low: 1.07365,
    open: 1.07365,
    time: 1675737720000,
    volume: 0,
  },
  {
    close: 1.07374,
    high: 1.0738,
    low: 1.07371,
    open: 1.0738,
    time: 1675737780000,
    volume: 0,
  },
  {
    close: 1.0738,
    high: 1.07385,
    low: 1.07371,
    open: 1.07374,
    time: 1675737840000,
    volume: 0,
  },
  {
    close: 1.07375,
    high: 1.07381,
    low: 1.07373,
    open: 1.0738,
    time: 1675737900000,
    volume: 0,
  },
  {
    close: 1.07375,
    high: 1.07375,
    low: 1.07372,
    open: 1.07375,
    time: 1675737960000,
    volume: 0,
  },
  {
    close: 1.07376,
    high: 1.0738,
    low: 1.07375,
    open: 1.07376,
    time: 1675738020000,
    volume: 0,
  },
  {
    close: 1.07391,
    high: 1.07393,
    low: 1.07376,
    open: 1.07377,
    time: 1675738080000,
    volume: 0,
  },
  {
    close: 1.0739,
    high: 1.07396,
    low: 1.07389,
    open: 1.07391,
    time: 1675738140000,
    volume: 0,
  },
  {
    close: 1.07385,
    high: 1.07396,
    low: 1.07385,
    open: 1.07389,
    time: 1675738200000,
    volume: 0,
  },
  {
    close: 1.074,
    high: 1.074,
    low: 1.07384,
    open: 1.07386,
    time: 1675738260000,
    volume: 0,
  },
  {
    close: 1.07401,
    high: 1.07407,
    low: 1.07399,
    open: 1.074,
    time: 1675738320000,
    volume: 0,
  },
  {
    close: 1.07399,
    high: 1.07401,
    low: 1.07397,
    open: 1.07401,
    time: 1675738380000,
    volume: 0,
  },
  {
    close: 1.07409,
    high: 1.0741,
    low: 1.074,
    open: 1.074,
    time: 1675738440000,
    volume: 0,
  },
  {
    close: 1.074,
    high: 1.07405,
    low: 1.074,
    open: 1.07405,
    time: 1675738500000,
    volume: 0,
  },
  {
    close: 1.07401,
    high: 1.07401,
    low: 1.07396,
    open: 1.074,
    time: 1675738560000,
    volume: 0,
  },
  {
    close: 1.07399,
    high: 1.07405,
    low: 1.07396,
    open: 1.074,
    time: 1675738620000,
    volume: 0,
  },
  {
    close: 1.07395,
    high: 1.074,
    low: 1.07389,
    open: 1.074,
    time: 1675738680000,
    volume: 0,
  },
  {
    close: 1.07404,
    high: 1.07407,
    low: 1.07395,
    open: 1.07395,
    time: 1675738740000,
    volume: 0,
  },
  {
    close: 1.07401,
    high: 1.07406,
    low: 1.07396,
    open: 1.07405,
    time: 1675738800000,
    volume: 0,
  },
  {
    close: 1.07401,
    high: 1.07403,
    low: 1.07396,
    open: 1.07401,
    time: 1675738860000,
    volume: 0,
  },
  {
    close: 1.07397,
    high: 1.07401,
    low: 1.07396,
    open: 1.07401,
    time: 1675738920000,
    volume: 0,
  },
  {
    close: 1.07405,
    high: 1.07409,
    low: 1.07397,
    open: 1.07397,
    time: 1675738980000,
    volume: 0,
  },
  {
    close: 1.07397,
    high: 1.07405,
    low: 1.07397,
    open: 1.07404,
    time: 1675739040000,
    volume: 0,
  },
  {
    close: 1.07393,
    high: 1.07397,
    low: 1.07385,
    open: 1.07397,
    time: 1675739100000,
    volume: 0,
  },
  {
    close: 1.07391,
    high: 1.07395,
    low: 1.07387,
    open: 1.07393,
    time: 1675739160000,
    volume: 0,
  },
  {
    close: 1.07389,
    high: 1.07394,
    low: 1.07386,
    open: 1.07391,
    time: 1675739220000,
    volume: 0,
  },
  {
    close: 1.0739,
    high: 1.07391,
    low: 1.07386,
    open: 1.07389,
    time: 1675739280000,
    volume: 0,
  },
  {
    close: 1.07396,
    high: 1.074,
    low: 1.07387,
    open: 1.0739,
    time: 1675739340000,
    volume: 0,
  },
  {
    close: 1.07397,
    high: 1.074,
    low: 1.07395,
    open: 1.07396,
    time: 1675739400000,
    volume: 0,
  },
  {
    close: 1.07395,
    high: 1.07397,
    low: 1.07395,
    open: 1.07397,
    time: 1675739460000,
    volume: 0,
  },
  {
    close: 1.07392,
    high: 1.07396,
    low: 1.0739,
    open: 1.07395,
    time: 1675739520000,
    volume: 0,
  },
  {
    close: 1.07387,
    high: 1.07394,
    low: 1.07386,
    open: 1.07392,
    time: 1675739580000,
    volume: 0,
  },
  {
    close: 1.07388,
    high: 1.07388,
    low: 1.07385,
    open: 1.07387,
    time: 1675739640000,
    volume: 0,
  },
  {
    close: 1.0738,
    high: 1.07394,
    low: 1.0738,
    open: 1.07388,
    time: 1675739700000,
    volume: 0,
  },
  {
    close: 1.07391,
    high: 1.07391,
    low: 1.0738,
    open: 1.0738,
    time: 1675739760000,
    volume: 0,
  },
  {
    close: 1.07386,
    high: 1.07392,
    low: 1.07385,
    open: 1.0739,
    time: 1675739820000,
    volume: 0,
  },
  {
    close: 1.07401,
    high: 1.07401,
    low: 1.07386,
    open: 1.07386,
    time: 1675739880000,
    volume: 0,
  },
  {
    close: 1.07402,
    high: 1.07402,
    low: 1.07396,
    open: 1.07401,
    time: 1675739940000,
    volume: 0,
  },
  {
    close: 1.07405,
    high: 1.07411,
    low: 1.074,
    open: 1.07401,
    time: 1675740000000,
    volume: 0,
  },
  {
    close: 1.07392,
    high: 1.07406,
    low: 1.0739,
    open: 1.07406,
    time: 1675740060000,
    volume: 0,
  },
  {
    close: 1.07386,
    high: 1.07397,
    low: 1.07384,
    open: 1.07392,
    time: 1675740120000,
    volume: 0,
  },
  {
    close: 1.07386,
    high: 1.0739,
    low: 1.07385,
    open: 1.07387,
    time: 1675740180000,
    volume: 0,
  },
  {
    close: 1.07385,
    high: 1.07388,
    low: 1.07381,
    open: 1.07386,
    time: 1675740240000,
    volume: 0,
  },
  {
    close: 1.07381,
    high: 1.07388,
    low: 1.0738,
    open: 1.07385,
    time: 1675740300000,
    volume: 0,
  },
  {
    close: 1.07381,
    high: 1.07383,
    low: 1.07381,
    open: 1.07381,
    time: 1675740360000,
    volume: 0,
  },
  {
    close: 1.07389,
    high: 1.0739,
    low: 1.0738,
    open: 1.07381,
    time: 1675740420000,
    volume: 0,
  },
  {
    close: 1.07385,
    high: 1.07392,
    low: 1.07385,
    open: 1.0739,
    time: 1675740480000,
    volume: 0,
  },
  {
    close: 1.07396,
    high: 1.074,
    low: 1.07384,
    open: 1.07384,
    time: 1675740540000,
    volume: 0,
  },
  {
    close: 1.07399,
    high: 1.07416,
    low: 1.07366,
    open: 1.07396,
    time: 1675740600000,
    volume: 0,
  },
  {
    close: 1.07372,
    high: 1.07399,
    low: 1.07368,
    open: 1.07396,
    time: 1675740660000,
    volume: 0,
  },
  {
    close: 1.0737,
    high: 1.07378,
    low: 1.07367,
    open: 1.07372,
    time: 1675740720000,
    volume: 0,
  },
  {
    close: 1.07359,
    high: 1.07373,
    low: 1.07357,
    open: 1.07372,
    time: 1675740780000,
    volume: 0,
  },
  {
    close: 1.07363,
    high: 1.07363,
    low: 1.07354,
    open: 1.0736,
    time: 1675740840000,
    volume: 0,
  },
  {
    close: 1.07361,
    high: 1.07369,
    low: 1.07355,
    open: 1.07363,
    time: 1675740900000,
    volume: 0,
  },
  {
    close: 1.07374,
    high: 1.07379,
    low: 1.07358,
    open: 1.07361,
    time: 1675740960000,
    volume: 0,
  },
  {
    close: 1.07366,
    high: 1.07378,
    low: 1.07365,
    open: 1.07375,
    time: 1675741020000,
    volume: 0,
  },
  {
    close: 1.07365,
    high: 1.07371,
    low: 1.07361,
    open: 1.07366,
    time: 1675741080000,
    volume: 0,
  },
  {
    close: 1.0737,
    high: 1.0737,
    low: 1.07362,
    open: 1.07366,
    time: 1675741140000,
    volume: 0,
  },
  {
    close: 1.07376,
    high: 1.07381,
    low: 1.0737,
    open: 1.0737,
    time: 1675741200000,
    volume: 0,
  },
  {
    close: 1.0738,
    high: 1.07381,
    low: 1.07371,
    open: 1.07376,
    time: 1675741260000,
    volume: 0,
  },
  {
    close: 1.07376,
    high: 1.07384,
    low: 1.07375,
    open: 1.0738,
    time: 1675741320000,
    volume: 0,
  },
  {
    close: 1.07384,
    high: 1.07387,
    low: 1.0737,
    open: 1.07376,
    time: 1675741380000,
    volume: 0,
  },
  {
    close: 1.0739,
    high: 1.0739,
    low: 1.07384,
    open: 1.07385,
    time: 1675741440000,
    volume: 0,
  },
  {
    close: 1.07384,
    high: 1.07391,
    low: 1.07384,
    open: 1.07387,
    time: 1675741500000,
    volume: 0,
  },
  {
    close: 1.07395,
    high: 1.07397,
    low: 1.07382,
    open: 1.07382,
    time: 1675741560000,
    volume: 0,
  },
  {
    close: 1.07401,
    high: 1.07404,
    low: 1.0739,
    open: 1.07395,
    time: 1675741620000,
    volume: 0,
  },
  {
    close: 1.07409,
    high: 1.0741,
    low: 1.074,
    open: 1.07401,
    time: 1675741680000,
    volume: 0,
  },
  {
    close: 1.07405,
    high: 1.0742,
    low: 1.07401,
    open: 1.07409,
    time: 1675741740000,
    volume: 0,
  },
  {
    close: 1.0742,
    high: 1.0742,
    low: 1.07404,
    open: 1.07404,
    time: 1675741800000,
    volume: 0,
  },
  {
    close: 1.07419,
    high: 1.0742,
    low: 1.07407,
    open: 1.07419,
    time: 1675741860000,
    volume: 0,
  },
  {
    close: 1.07397,
    high: 1.0742,
    low: 1.07395,
    open: 1.07419,
    time: 1675741920000,
    volume: 0,
  },
  {
    close: 1.07375,
    high: 1.07395,
    low: 1.07375,
    open: 1.07395,
    time: 1675741980000,
    volume: 0,
  },
  {
    close: 1.0737,
    high: 1.07376,
    low: 1.07365,
    open: 1.07375,
    time: 1675742040000,
    volume: 0,
  },
  {
    close: 1.0737,
    high: 1.0738,
    low: 1.0737,
    open: 1.0737,
    time: 1675742100000,
    volume: 0,
  },
  {
    close: 1.07376,
    high: 1.07378,
    low: 1.07357,
    open: 1.07366,
    time: 1675742160000,
    volume: 0,
  },
  {
    close: 1.07381,
    high: 1.07382,
    low: 1.07369,
    open: 1.07376,
    time: 1675742220000,
    volume: 0,
  },
  {
    close: 1.07376,
    high: 1.07386,
    low: 1.07376,
    open: 1.07381,
    time: 1675742280000,
    volume: 0,
  },
  {
    close: 1.07375,
    high: 1.07379,
    low: 1.07369,
    open: 1.07376,
    time: 1675742340000,
    volume: 0,
  },
  {
    close: 1.0736,
    high: 1.07377,
    low: 1.07356,
    open: 1.07377,
    time: 1675742400000,
    volume: 0,
  },
  {
    close: 1.07365,
    high: 1.07369,
    low: 1.07358,
    open: 1.07358,
    time: 1675742460000,
    volume: 0,
  },
  {
    close: 1.0737,
    high: 1.07374,
    low: 1.07364,
    open: 1.07365,
    time: 1675742520000,
    volume: 0,
  },
  {
    close: 1.07374,
    high: 1.07377,
    low: 1.0737,
    open: 1.0737,
    time: 1675742580000,
    volume: 0,
  },
  {
    close: 1.07366,
    high: 1.07374,
    low: 1.07366,
    open: 1.07374,
    time: 1675742640000,
    volume: 0,
  },
  {
    close: 1.07364,
    high: 1.07369,
    low: 1.07362,
    open: 1.07369,
    time: 1675742700000,
    volume: 0,
  },
  {
    close: 1.07357,
    high: 1.07365,
    low: 1.07355,
    open: 1.07364,
    time: 1675742760000,
    volume: 0,
  },
];

function getRandomArbitrary(min: number, max: number) {
  return Math.round(Math.random() * (max - min) + min);
}

export default function App() {
  const chartRef = useRef<CandleSticksChartRef>(null);
  useEffect(() => {
    const id = setInterval(() => {
      const l = getRandomArbitrary(0, candles.length - 1);
      chartRef.current?.append({
        ...candles[l]!,
        time: Date.now(),
      });
    }, 1000);

    return () => {
      clearInterval(id);
    };
  }, []);

  return (
    <View style={styles.container}>
      <CandleSticksChart ref={chartRef} data={candles} style={styles.box} />
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: 'center',
    justifyContent: 'center',
  },
  box: {
    width: '100%',
    height: 300,
    backgroundColor: 'white',
  },
});
